frontend https
    bind :443
    mode tcp
    option tcplog
    timeout client 1m
    tcp-request inspect-delay 5s
    tcp-request content capture req.ssl_sni len 100
    log-format "capture0: %[capture.req.hdr(0)]"
    tcp-request content accept if { req_ssl_hello_type 1 }

    acl acl_jenkins req.ssl_sni -i jenkins.zevrant-services.internal
    use_backend https_jenkins if acl_jenkins

    acl acl_vault req.ssl_sni -i vault.zevrant-services.com
    use_backend vault if acl_vault

    acl acl_fence-gurus-beta req.ssl_sni -i the-fence-gurus.beta.zevrant-services.com
    use_backend fence-gurus-beta if acl_fence-gurus-beta

    acl acl_nextcloud req.ssl_sni -i next.zevrant-services.com
    use_backend nextcloud if acl_nextcloud

    acl acl_s3 req.ssl_sni -i s3.zevrant-services.com
    use_backend s3 if acl_s3

    acl acl_s3 req.ssl_sni -i s3.zevrant-services.internal
    use_backend s3 if acl_s3

    acl acl_thefencegurusllc req.ssl_sni -i thefencegurusllc.com
    use_backend fence-gurus-llc if acl_thefencegurusllc

    acl acl_zevrantServices req.ssl_sni -i zevrant-services.com
    use_backend zevrant-services if acl_zevrantServices

    acl acl_zevrantServicesBeta req.ssl_sni -i beta.zevrant-services.com
    use_backend zevrant-services-beta if acl_zevrantServicesBeta

backend vault
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.1.0.6:8200 check

backend https_jenkins
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.1.0.3:8443 check

backend fence-gurus-beta
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.1.0.11:8080

backend nextcloud
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.0.0.4:443

backend s3
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server s3 127.0.0.1:9000

backend fence-gurus-llc
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.1.0.13:8080

backend zevrant-services
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server blue 10.1.0.15:8080
    server green 10.1.0.16:8080

backend zevrant-services-beta
    mode tcp
    balance roundrobin
    timeout connect 5s
    timeout server 1m
    server primary 10.1.0.14:8080


